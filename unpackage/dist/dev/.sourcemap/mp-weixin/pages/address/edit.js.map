{"version":3,"file":"edit.js","sources":["pages/address/edit.uvue","C:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYWRkcmVzcy9lZGl0LnV2dWU"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<view class=\"form-card\">\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"label\">联系人</text>\r\n\t\t\t\t<input class=\"input\" type=\"text\" v-model=\"form.contact_name\" placeholder=\"请填写收货人姓名\" placeholder-class=\"placeholder\" />\r\n\t\t\t</view>\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"label\">手机号</text>\r\n\t\t\t\t<input class=\"input\" type=\"number\" v-model=\"form.contact_phone\" placeholder=\"请填写收货人手机号\" placeholder-class=\"placeholder\" maxlength=\"11\" />\r\n\t\t\t</view>\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"label\">收货地址</text>\r\n\t\t\t\t<input class=\"input\" type=\"text\" v-model=\"form.address\" placeholder=\"小区/写字楼/学校等\" placeholder-class=\"placeholder\" />\r\n\t\t\t</view>\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"label\">门牌号</text>\r\n\t\t\t\t<input class=\"input\" type=\"text\" v-model=\"form.detail\" placeholder=\"例：8号楼808室\" placeholder-class=\"placeholder\" />\r\n\t\t\t</view>\r\n\t\t\t<view class=\"form-item switch-item\">\r\n\t\t\t\t<text class=\"label\">设为默认地址</text>\r\n\t\t\t\t<switch :checked=\"form.is_default\" color=\"#FF69B4\" @change=\"onSwitchChange\" />\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"footer-btns\">\r\n\t\t\t<button class=\"save-btn\" @click=\"saveAddress\">\r\n\t\t\t\t<text class=\"save-text\">保存地址</text>\r\n\t\t\t</button>\r\n\t\t\t<button class=\"delete-btn\" v-if=\"isEdit\" @click=\"deleteAddress\">\r\n\t\t\t\t<text class=\"delete-text\">删除地址</text>\r\n\t\t\t</button>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script lang=\"uts\">\r\n\timport { BASE_URL } from '@/common/config.uts'\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tisEdit: false,\r\n\t\t\t\tid: '',\r\n\t\t\t\tform: {\r\n\t\t\t\t\tcontact_name: '',\r\n\t\t\t\t\tcontact_phone: '',\r\n\t\t\t\t\taddress: '',\r\n\t\t\t\t\tdetail: '',\r\n\t\t\t\t\tis_default: false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(options: any) {\r\n\t\t\tif (options.id) {\r\n\t\t\t\tthis.isEdit = true\r\n\t\t\t\tthis.id = options.id\r\n\t\t\t\tthis.fetchAddressDetail(options.id)\r\n\t\t\t\tuni.setNavigationBarTitle({ title: '♡ 编辑地址 ♡' })\r\n\t\t\t} else {\r\n\t\t\t\tuni.setNavigationBarTitle({ title: '♡ 新增地址 ♡' })\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tfetchAddressDetail(id: string) {\r\n\t\t\t\tconst token = uni.getStorageSync('token')\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: `${BASE_URL}/addresses/${id}`,\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\theader: { 'Authorization': `Bearer ${token}` },\r\n\t\t\t\t\tsuccess: (res: any) => {\r\n\t\t\t\t\t\tif (res.data.success && res.data.data.address) {\r\n\t\t\t\t\t\t\tconst addr = res.data.data.address\r\n\t\t\t\t\t\t\t// 适配后端返回的字段 name/phone/detail\r\n\t\t\t\t\t\t\tthis.form = {\r\n\t\t\t\t\t\t\t\tcontact_name: addr.name || addr.contact_name,\r\n\t\t\t\t\t\t\t\tcontact_phone: addr.phone || addr.contact_phone,\r\n\t\t\t\t\t\t\t\t// 这里简单处理，将 detail 拆分或者直接显示\r\n\t\t\t\t\t\t\t\taddress: addr.detail || addr.address, \r\n\t\t\t\t\t\t\t\tdetail: '', // 既然 detail 已经包含了完整地址，这里可以留空，或者尝试拆分\r\n\t\t\t\t\t\t\t\tis_default: !!addr.is_default\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tonSwitchChange(e: any) {\r\n\t\t\t\tthis.form.is_default = e.detail.value\r\n\t\t\t},\r\n\r\n\t\t\tsaveAddress() {\r\n\t\t\t\tif (!this.form.contact_name || !this.form.contact_phone || !this.form.address) {\r\n\t\t\t\t\tuni.showToast({ title: '请填写完整信息', icon: 'none' })\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tif (!/^1\\d{10}$/.test(this.form.contact_phone)) {\r\n\t\t\t\t\tuni.showToast({ title: '手机号格式不正确', icon: 'none' })\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst token = uni.getStorageSync('token')\r\n\t\t\t\tconst url = this.isEdit ? `${BASE_URL}/addresses/${this.id}` : `${BASE_URL}/addresses`\r\n\t\t\t\tconst method = this.isEdit ? 'PUT' : 'POST'\r\n\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: url,\r\n\t\t\t\t\tmethod: method,\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'Authorization': `Bearer ${token}`,\r\n\t\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdata: this.form,\r\n\t\t\t\t\tsuccess: (res: any) => {\r\n\t\t\t\t\t\tif (res.data.success) {\r\n\t\t\t\t\t\t\tuni.showToast({ title: '保存成功', icon: 'success' })\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\tuni.navigateBack()\r\n\t\t\t\t\t\t\t}, 1500)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.showToast({ title: res.data.message || '保存失败', icon: 'none' })\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tdeleteAddress() {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\tcontent: '确定要删除这个地址吗？',\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\tconst token = uni.getStorageSync('token')\r\n\t\t\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\t\t\turl: `${BASE_URL}/addresses/${this.id}`,\r\n\t\t\t\t\t\t\t\tmethod: 'DELETE',\r\n\t\t\t\t\t\t\t\theader: { 'Authorization': `Bearer ${token}` },\r\n\t\t\t\t\t\t\t\tsuccess: (res: any) => {\r\n\t\t\t\t\t\t\t\t\tif (res.data.success) {\r\n\t\t\t\t\t\t\t\t\t\tuni.showToast({ title: '删除成功', icon: 'success' })\r\n\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\tuni.navigateBack()\r\n\t\t\t\t\t\t\t\t\t\t}, 1500)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.container {\r\n\t\tmin-height: 100vh;\r\n\t\tbackground-color: #FFF5F8;\r\n\t\tpadding: 30rpx;\r\n\t}\r\n\r\n\t.form-card {\r\n\t\tbackground-color: #FFFFFF;\r\n\t\tborder-radius: 30rpx;\r\n\t\tpadding: 0 30rpx;\r\n\t\tbox-shadow: 0 4rpx 16rpx rgba(255, 105, 180, 0.1);\r\n\t}\r\n\r\n\t.form-item {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\talign-items: center;\r\n\t\tpadding: 36rpx 0;\r\n\t\tborder-bottom: 1px solid #FFF0F5;\r\n\t}\r\n\r\n\t.form-item:last-child {\r\n\t\tborder-bottom: none;\r\n\t}\r\n\r\n\t.label {\r\n\t\twidth: 180rpx;\r\n\t\tfont-size: 30rpx;\r\n\t\tcolor: #5D4E6D;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\r\n\t.input {\r\n\t\tflex: 1;\r\n\t\tfont-size: 30rpx;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.placeholder {\r\n\t\tcolor: #CCC;\r\n\t}\r\n\r\n\t.switch-item {\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\r\n\t.footer-btns {\r\n\t\tmargin-top: 60rpx;\r\n\t}\r\n\r\n\t.save-btn {\r\n\t\tbackground: linear-gradient(135deg, #FFB6C1 0%, #FF69B4 100%);\r\n\t\tborder-radius: 40rpx;\r\n\t\theight: 88rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tborder: none;\r\n\t\tbox-shadow: 0 8rpx 20rpx rgba(255, 105, 180, 0.3);\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n\t\r\n\t.save-btn:active {\r\n\t\ttransform: scale(0.98);\r\n\t}\r\n\r\n\t.save-text {\r\n\t\tcolor: #FFFFFF;\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: bold;\r\n\t\tletter-spacing: 1px;\r\n\t}\r\n\r\n\t.delete-btn {\r\n\t\tbackground-color: #FFFFFF;\r\n\t\tborder-radius: 40rpx;\r\n\t\theight: 88rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tborder: 2rpx solid #FFB6C1;\r\n\t}\r\n\t\r\n\t.delete-btn:active {\r\n\t\tbackground-color: #FFF0F5;\r\n\t}\r\n\r\n\t.delete-text {\r\n\t\tcolor: #FF69B4;\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: bold;\r\n\t}\r\n</style>\r\n","import MiniProgramPage from 'D:/order/fontend/pages/address/edit.uvue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","uni","BASE_URL","res"],"mappings":"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"}