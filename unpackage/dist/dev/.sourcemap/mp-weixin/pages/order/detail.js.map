{"version":3,"file":"detail.js","sources":["pages/order/detail.uvue","C:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvb3JkZXIvZGV0YWlsLnV2dWU"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<view class=\"section header\">\n\t\t\t<view class=\"row\">\n\t\t\t\t<text class=\"label\">订单号</text>\n\t\t\t\t<text class=\"value mono\">{{order.order_number || '-'}}</text>\n\t\t\t</view>\n\t\t\t<view class=\"row\">\n\t\t\t\t<text class=\"label\">状态</text>\n\t\t\t\t<text class=\"value status\" :class=\"`status-${order.status}`\">{{statusText}}</text>\n\t\t\t</view>\n\t\t\t<view class=\"row\">\n\t\t\t\t<text class=\"label\">类型</text>\n\t\t\t\t<text class=\"value\">{{orderTypeLabel}}</text>\n\t\t\t</view>\n\t\t\t<view class=\"row\">\n\t\t\t\t<text class=\"label\">下单时间</text>\n\t\t\t\t<text class=\"value\">{{order.created_at || '-'}}</text>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<view class=\"section\">\n\t\t\t<text class=\"section-title\">联系信息</text>\n\t\t\t<view class=\"row\">\n\t\t\t\t<text class=\"label\">联系人</text>\n\t\t\t\t<text class=\"value\">{{order.contact_name || '-'}}</text>\n\t\t\t</view>\n\t\t\t<view class=\"row\">\n\t\t\t\t<text class=\"label\">手机号</text>\n\t\t\t\t<text class=\"value\">{{order.contact_phone || '-'}}</text>\n\t\t\t</view>\n\t\t\t<view class=\"row\" v-if=\"order.order_type === 'delivery'\">\n\t\t\t\t<text class=\"label\">收货地址</text>\n\t\t\t\t<text class=\"value\">{{order.delivery_address || '-'}}</text>\n\t\t\t</view>\n\t\t\t<view class=\"row\" v-if=\"order.order_type === 'pickup' && order.pickup_code\">\n\t\t\t\t<text class=\"label\">取餐码</text>\n\t\t\t\t<text class=\"value strong\">{{order.pickup_code}}</text>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<view class=\"section\">\n\t\t\t<text class=\"section-title\">商品清单</text>\n\t\t\t<view class=\"item\" v-for=\"item in order.items\" :key=\"item.id\">\n\t\t\t\t<image class=\"item-img\" :src=\"getProductImage(item)\" mode=\"aspectFill\"></image>\n\t\t\t\t<view class=\"item-info\">\n\t\t\t\t\t<text class=\"item-name\">{{item.product_name || '商品'}}</text>\n\t\t\t\t\t<text class=\"item-spec\" v-if=\"item.specs\">{{specString(item.specs)}}</text>\n\t\t\t\t\t<text class=\"item-note\" v-if=\"item.notes\">{{item.notes}}</text>\n\t\t\t\t\t<view class=\"item-bottom\">\n\t\t\t\t\t\t<text class=\"item-price\">￥{{item.price}}</text>\n\t\t\t\t\t\t<text class=\"item-qty\">x{{item.quantity}}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<view class=\"section\">\n\t\t\t<text class=\"section-title\">金额信息</text>\n\t\t\t<view class=\"row\">\n\t\t\t\t<text class=\"label\">商品金额</text>\n\t\t\t\t<text class=\"value\">￥{{order.total_amount || 0}}</text>\n\t\t\t</view>\n\t\t\t<view class=\"row\" v-if=\"order.order_type === 'delivery'\">\n\t\t\t\t<text class=\"label\">配送费</text>\n\t\t\t\t<text class=\"value\">￥{{order.delivery_fee || 0}}</text>\n\t\t\t</view>\n\t\t\t<view class=\"row total\">\n\t\t\t\t<text class=\"label\">合计</text>\n\t\t\t\t<text class=\"value total-amount\">￥{{order.total_amount || 0}}</text>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<view class=\"section\" v-if=\"order.notes\">\n\t\t\t<text class=\"section-title\">备注</text>\n\t\t\t<text class=\"remark\">{{order.notes}}</text>\n\t\t</view>\n\n\t</view>\n</template>\n\n<script lang=\"uts\">\n\timport { BASE_URL } from '@/common/config.uts'\n\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\torderId: 0,\n\t\t\t\torder: {\n\t\t\t\t\titems: []\n\t\t\t\t} as any,\n\t\t\t\tloading: false\n\t\t\t}\n\t\t},\n\t\tcomputed: {\n\t\t\tstatusText(): string {\n\t\t\t\tconst map: Record<string, string> = {\n\t\t\t\t\t'pending': '待确认',\n\t\t\t\t\t'confirmed': '已确认',\n\t\t\t\t\t'preparing': '制作中',\n\t\t\t\t\t'ready': '待取餐',\n\t\t\t\t\t'delivering': '配送中',\n\t\t\t\t\t'delivered': '已完成',\n\t\t\t\t\t'cancelled': '已取消'\n\t\t\t\t}\n\t\t\t\treturn map[this.order?.status] || this.order?.status || ''\n\t\t\t},\n\t\t\torderTypeLabel(): string {\n\t\t\t\tconst map: Record<string, string> = {\n\t\t\t\t\t'delivery': '外卖',\n\t\t\t\t\t'pickup': '自取',\n\t\t\t\t\t'dine_in': '堂食'\n\t\t\t\t}\n\t\t\t\treturn map[this.order?.order_type] || this.order?.order_type || ''\n\t\t\t}\n\t\t},\n\t\tonLoad(options: any) {\n\t\t\tif (options?.id) {\n\t\t\t\tthis.orderId = Number(options.id)\n\t\t\t\tthis.fetchDetail()\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\tgetProductImage(item: any): string {\n\t\t\t\tif (item.images && item.images.length > 0) return item.images[0]\n\t\t\t\treturn DEFAULT_FOOD_IMAGE\n\t\t\t},\n\t\t\tspecString(specs: any): string {\n\t\t\t\tif (!specs) return ''\n\t\t\t\tif (typeof specs === 'string') return specs\n\t\t\t\treturn Object.entries(specs).map(([k, v]) => `${k}:${v}`).join(' ')\n\t\t\t},\n\t\t\tfetchDetail() {\n\t\t\t\tconst token = uni.getStorageSync('token')\n\t\t\t\tif (!token) {\n\t\t\t\t\tuni.navigateTo({ url: '/pages/login/login' })\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tthis.loading = true\n\t\t\t\tuni.request({\n\t\t\t\t\turl: `${BASE_URL}/orders/${this.orderId}`,\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\theader: { 'Authorization': `Bearer ${token}` },\n\t\t\t\t\tsuccess: (res: any) => {\n\t\t\t\t\t\tif (res.data.success && res.data.data) {\n\t\t\t\t\t\t\tconst data = res.data.data\n\t\t\t\t\t\t\tthis.order = data.order || data\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showToast({ title: res.data?.message || '获取详情失败', icon: 'none' })\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfail: () => {\n\t\t\t\t\t\tuni.showToast({ title: '网络错误', icon: 'none' })\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\tthis.loading = false\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tpayOrder() {\n\t\t\t\tconst token = uni.getStorageSync('token')\n\t\t\t\tif (!token) {\n\t\t\t\t\tuni.navigateTo({ url: '/pages/login/login' })\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tuni.showLoading({ title: '支付中...' })\n\t\t\t\tuni.request({\n\t\t\t\t\turl: `${BASE_URL}/orders/${this.orderId}/pay`,\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\theader: { 'Authorization': `Bearer ${token}` },\n\t\t\t\t\tsuccess: (res: any) => {\n\t\t\t\t\t\tif (res.data?.success) {\n\t\t\t\t\t\t\tuni.showToast({ title: '支付成功', icon: 'success' })\n\t\t\t\t\t\t\tthis.fetchDetail()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showToast({ title: res.data?.message || '支付失败', icon: 'none' })\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfail: () => {\n\t\t\t\t\t\tuni.showToast({ title: '网络错误', icon: 'none' })\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tdeleteOrder() {\n\t\t\t\tconst token = uni.getStorageSync('token')\n\t\t\t\tif (!token) {\n\t\t\t\t\tuni.navigateTo({ url: '/pages/login/login' })\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tuni.showModal({\n\t\t\t\t\ttitle: '删除订单',\n\t\t\t\t\tcontent: '确定删除该订单吗？',\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tif (!res.confirm) return\n\t\t\t\t\t\tuni.request({\n\t\t\t\t\t\t\turl: `${BASE_URL}/orders/${this.orderId}`,\n\t\t\t\t\t\t\tmethod: 'DELETE',\n\t\t\t\t\t\t\theader: { 'Authorization': `Bearer ${token}` },\n\t\t\t\t\t\t\tsuccess: (resp: any) => {\n\t\t\t\t\t\t\t\tif (resp.data?.success) {\n\t\t\t\t\t\t\t\t\tuni.showToast({ title: '已删除', icon: 'success' })\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\tuni.switchTab({ url: '/pages/order/list' })\n\t\t\t\t\t\t\t\t\t}, 800)\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tuni.showToast({ title: resp.data?.message || '删除失败', icon: 'none' })\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfail: () => {\n\t\t\t\t\t\t\t\tuni.showToast({ title: '网络错误', icon: 'none' })\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\t.container {\n\t\tmin-height: 100vh;\n\t\tbackground-color: #FFF5F8;\n\t\tpadding-bottom: 140rpx;\n\t}\n\n\t.section {\n\t\tbackground: rgba(255, 255, 255, 0.95);\n\t\tmargin: 24rpx;\n\t\tpadding: 32rpx;\n\t\tborder-radius: 36rpx;\n\t\tbox-shadow: 0 8rpx 24rpx rgba(255, 105, 180, 0.12);\n\t\tborder: 1px solid rgba(255, 255, 255, 0.6);\n\t}\n\n\t.section-title {\n\t\tfont-size: 32rpx;\n\t\tfont-weight: 800;\n\t\tcolor: #5D4E6D;\n\t\tborder-left: 8rpx solid #FF69B4;\n\t\tpadding-left: 18rpx;\n\t\tmargin-bottom: 18rpx;\n\t}\n\n\t.header .row {\n\t\tmargin-bottom: 12rpx;\n\t}\n\n\t.row {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-top: 12rpx;\n\t}\n\n\t.label {\n\t\tfont-size: 28rpx;\n\t\tcolor: #B8A9C9;\n\t}\n\n\t.value {\n\t\tfont-size: 28rpx;\n\t\tcolor: #5D4E6D;\n\t\tfont-weight: 600;\n\t\ttext-align: right;\n\t}\n\n\t.value.mono {\n\t\tfont-family: monospace;\n\t}\n\n\t.value.status {\n\t\tcolor: #FF69B4;\n\t}\n\n\t.status-pending {\n\t\tcolor: #FF9800 !important;\n\t}\n\n\t.status-confirmed {\n\t\tcolor: #4CAF50 !important;\n\t}\n\n\t.status-preparing {\n\t\tcolor: #FF9800 !important;\n\t}\n\n\t.status-ready {\n\t\tcolor: #4CAF50 !important;\n\t}\n\n\t.status-delivering {\n\t\tcolor: #2196F3 !important;\n\t}\n\n\t.status-delivered {\n\t\tcolor: #9C27B0 !important;\n\t}\n\n\t.status-cancelled {\n\t\tcolor: #9E9E9E !important;\n\t}\n\n\t.value.strong {\n\t\tcolor: #FF69B4;\n\t\tfont-weight: 800;\n\t}\n\n\t.address-display {\n\t\tmargin-top: 10rpx;\n\t}\n\n\t.item {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tmargin-top: 20rpx;\n\t}\n\n\t.item-img {\n\t\twidth: 120rpx;\n\t\theight: 120rpx;\n\t\tborder-radius: 20rpx;\n\t\tborder: 4rpx solid #FFF0F5;\n\t}\n\n\t.item-info {\n\t\tflex: 1;\n\t\tmargin-left: 20rpx;\n\t}\n\n\t.item-name {\n\t\tfont-size: 30rpx;\n\t\tcolor: #5D4E6D;\n\t\tfont-weight: 700;\n\t}\n\n\t.item-spec, .item-note {\n\t\tfont-size: 26rpx;\n\t\tcolor: #B8A9C9;\n\t\tmargin-top: 6rpx;\n\t}\n\n\t.item-bottom {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-top: 12rpx;\n\t}\n\n\t.item-price {\n\t\tfont-size: 30rpx;\n\t\tcolor: #FF69B4;\n\t\tfont-weight: 800;\n\t}\n\n\t.item-qty {\n\t\tfont-size: 26rpx;\n\t\tcolor: #B8A9C9;\n\t}\n\n\t.total {\n\t\tmargin-top: 14rpx;\n\t}\n\n\t.total-amount {\n\t\tcolor: #FF69B4;\n\t\tfont-weight: 900;\n\t}\n\n\t.remark {\n\t\tfont-size: 28rpx;\n\t\tcolor: #5D4E6D;\n\t}\n\n</style>\n","import MiniProgramPage from 'D:/order/fontend/pages/order/detail.uvue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","__read","uni","BASE_URL"],"mappings":"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"}