{"code":"import { __awaiter } from \"tslib\";\nimport { defineComponent } from \"vue\";\nimport { BASE_URL } from \"@/common/config\";\nexport default defineComponent({\n    data() {\n        return {\n            phone: '',\n            password: '',\n            confirmPassword: ''\n        };\n    },\n    methods: {\n        handleRegister() {\n            var _a;\n            return __awaiter(this, void 0, void 0, function* () {\n                if (!this.phone) {\n                    uni.showToast({ title: '请输入手机号', icon: 'none' });\n                    return Promise.resolve(null);\n                }\n                if (!this.password) {\n                    uni.showToast({ title: '请输入密码', icon: 'none' });\n                    return Promise.resolve(null);\n                }\n                if (this.password.length < 6 || this.password.length > 20) {\n                    uni.showToast({ title: '密码长度为6-20位', icon: 'none' });\n                    return Promise.resolve(null);\n                }\n                if (this.password !== this.confirmPassword) {\n                    uni.showToast({ title: '两次输入密码不一致', icon: 'none' });\n                    return Promise.resolve(null);\n                }\n                let loadingShown = false;\n                try {\n                    uni.showLoading({ title: '注册中...' });\n                    loadingShown = true;\n                    const res = yield new Promise((resolve, reject) => {\n                        uni.__f__('log', 'at pages/register/register.uvue:88', '注册请求 payload:', new UTSJSONObject({\n                            phone: this.phone,\n                            password: this.password\n                        }));\n                        uni.request({\n                            url: `${BASE_URL}/auth/register`,\n                            method: 'POST',\n                            header: new UTSJSONObject({\n                                'Content-Type': 'application/json'\n                            }),\n                            data: new UTSJSONObject({\n                                phone: this.phone,\n                                password: this.password\n                            }),\n                            success: (resp) => {\n                                uni.__f__('log', 'at pages/register/register.uvue:103', '注册响应:', resp);\n                                resolve(resp);\n                            },\n                            fail: reject\n                        });\n                    });\n                    if ((res.statusCode === 200 || res.statusCode === 201) && res.data && res.data.success) {\n                        if (res.data.data && res.data.data.token) {\n                            uni.setStorageSync('token', res.data.data.token);\n                            if (res.data.data.user) {\n                                uni.setStorageSync('userInfo', res.data.data.user);\n                            }\n                        }\n                        uni.showToast({ title: '注册成功', icon: 'success' });\n                        setTimeout(() => {\n                            uni.reLaunch({ url: '/pages/index/index' });\n                        }, 1200);\n                    }\n                    else {\n                        const msg = ((_a = res.data) === null || _a === void 0 ? null : _a.message) || `注册失败（${res.statusCode || '未知错误'}）`;\n                        uni.showToast({ title: msg, icon: 'none' });\n                    }\n                }\n                catch (error) {\n                    uni.showToast({ title: '网络错误', icon: 'none' });\n                }\n                finally {\n                    if (loadingShown) {\n                        uni.hideLoading();\n                    }\n                }\n            });\n        },\n        goToLogin() {\n            const pages = getCurrentPages();\n            if (pages.length > 1) {\n                uni.navigateBack();\n            }\n            else {\n                uni.redirectTo({ url: '/pages/login/login' });\n            }\n        },\n        goAgreement() {\n            uni.navigateTo({ url: '/pages/legal/agreement' });\n        },\n        goPrivacy() {\n            uni.navigateTo({ url: '/pages/legal/privacy' });\n        }\n    }\n});\n//# sourceMappingURL=D:/order/fontend/pages/register/register.uvue?vue&type=script&lang.uts.js.map","references":[],"uniExtApis":["uni.showToast","uni.showLoading","uni.__f__","uni.request","uni.setStorageSync","uni.reLaunch","uni.hideLoading","uni.navigateBack","uni.redirectTo","uni.navigateTo"],"map":"{\"version\":3,\"file\":\"register.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"register.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
