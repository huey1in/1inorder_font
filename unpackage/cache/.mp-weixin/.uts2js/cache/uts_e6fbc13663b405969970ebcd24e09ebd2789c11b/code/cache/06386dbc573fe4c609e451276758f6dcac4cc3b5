{"code":"import { defineComponent } from \"vue\";\nimport { BASE_URL } from \"@/common/config\";\nexport default defineComponent({\n    data() {\n        return {\n            isEdit: false,\n            id: '',\n            form: new UTSJSONObject({\n                contact_name: '',\n                contact_phone: '',\n                address: '',\n                detail: '',\n                is_default: false\n            })\n        };\n    },\n    onLoad(options = null) {\n        if (options.id) {\n            this.isEdit = true;\n            this.id = options.id;\n            this.fetchAddressDetail(options.id);\n            uni.setNavigationBarTitle({ title: '♡ 编辑地址 ♡' });\n        }\n        else {\n            uni.setNavigationBarTitle({ title: '♡ 新增地址 ♡' });\n        }\n    },\n    methods: {\n        fetchAddressDetail(id) {\n            const token = uni.getStorageSync('token');\n            uni.request({\n                url: `${BASE_URL}/addresses/${id}`,\n                method: 'GET',\n                header: new UTSJSONObject({ 'Authorization': `Bearer ${token}` }),\n                success: (res = null) => {\n                    if (res.data.success && res.data.data.address) {\n                        const addr = res.data.data.address;\n                        // 适配后端返回的字段 name/phone/detail\n                        this.form = {\n                            contact_name: addr.name || addr.contact_name,\n                            contact_phone: addr.phone || addr.contact_phone,\n                            // 这里简单处理，将 detail 拆分或者直接显示\n                            address: addr.detail || addr.address,\n                            detail: '',\n                            is_default: !!addr.is_default\n                        };\n                    }\n                }\n            });\n        },\n        onSwitchChange(e = null) {\n            this.form.is_default = e.detail.value;\n        },\n        saveAddress() {\n            if (!this.form.contact_name || !this.form.contact_phone || !this.form.address) {\n                uni.showToast({ title: '请填写完整信息', icon: 'none' });\n                return null;\n            }\n            if (!/^1\\d{10}$/.test(this.form.contact_phone)) {\n                uni.showToast({ title: '手机号格式不正确', icon: 'none' });\n                return null;\n            }\n            const token = uni.getStorageSync('token');\n            const url = this.isEdit ? `${BASE_URL}/addresses/${this.id}` : `${BASE_URL}/addresses`;\n            const method = this.isEdit ? 'PUT' : 'POST';\n            uni.request({\n                url: url,\n                method: method,\n                header: new UTSJSONObject({\n                    'Authorization': `Bearer ${token}`,\n                    'Content-Type': 'application/json'\n                }),\n                data: this.form,\n                success: (res = null) => {\n                    if (res.data.success) {\n                        uni.showToast({ title: '保存成功', icon: 'success' });\n                        setTimeout(() => {\n                            uni.navigateBack();\n                        }, 1500);\n                    }\n                    else {\n                        uni.showToast({ title: res.data.message || '保存失败', icon: 'none' });\n                    }\n                }\n            });\n        },\n        deleteAddress() {\n            uni.showModal(new UTSJSONObject({\n                title: '提示',\n                content: '确定要删除这个地址吗？',\n                success: (res) => {\n                    if (res.confirm) {\n                        const token = uni.getStorageSync('token');\n                        uni.request({\n                            url: `${BASE_URL}/addresses/${this.id}`,\n                            method: 'DELETE',\n                            header: new UTSJSONObject({ 'Authorization': `Bearer ${token}` }),\n                            success: (res = null) => {\n                                if (res.data.success) {\n                                    uni.showToast({ title: '删除成功', icon: 'success' });\n                                    setTimeout(() => {\n                                        uni.navigateBack();\n                                    }, 1500);\n                                }\n                            }\n                        });\n                    }\n                }\n            }));\n        }\n    }\n});\n//# sourceMappingURL=D:/order/fontend/pages/address/edit.uvue?vue&type=script&lang.uts.js.map","references":[],"uniExtApis":["uni.setNavigationBarTitle","uni.getStorageSync","uni.request","uni.showToast","uni.navigateBack","uni.showModal"],"map":"{\"version\":3,\"file\":\"edit.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"edit.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
