{"code":"import { __read } from \"tslib\";\nimport { defineComponent } from \"vue\";\nimport { BASE_URL } from \"@/common/config\";\nexport default defineComponent({\n    data() {\n        return {\n            orderId: 0,\n            order: {\n                items: []\n            },\n            loading: false\n        };\n    },\n    computed: {\n        statusText() {\n            var _a, _b;\n            const map = {\n                'pending': '待确认',\n                'confirmed': '已确认',\n                'preparing': '制作中',\n                'ready': '待取餐',\n                'delivering': '配送中',\n                'delivered': '已完成',\n                'cancelled': '已取消'\n            };\n            return map[(_a = this.order) === null || _a === void 0 ? null : _a.status] || ((_b = this.order) === null || _b === void 0 ? null : _b.status) || '';\n        },\n        orderTypeLabel() {\n            var _a, _b;\n            const map = {\n                'delivery': '外卖',\n                'pickup': '自取',\n                'dine_in': '堂食'\n            };\n            return map[(_a = this.order) === null || _a === void 0 ? null : _a.order_type] || ((_b = this.order) === null || _b === void 0 ? null : _b.order_type) || '';\n        }\n    },\n    onLoad(options = null) {\n        if (options === null || options === void 0 ? null : options.id) {\n            this.orderId = Number(options.id);\n            this.fetchDetail();\n        }\n    },\n    methods: {\n        getProductImage(item = null) {\n            if (item.images && item.images.length > 0)\n                return item.images[0];\n            return DEFAULT_FOOD_IMAGE;\n        },\n        specString(specs = null) {\n            if (!specs)\n                return '';\n            if (typeof specs === 'string')\n                return specs;\n            return Object.entries(specs).map((_a) => {\n                var _b = __read(_a, 2), k = _b[0], v = _b[1];\n                return `${k}:${v}`;\n            }).join(' ');\n        },\n        fetchDetail() {\n            const token = uni.getStorageSync('token');\n            if (!token) {\n                uni.navigateTo({ url: '/pages/login/login' });\n                return null;\n            }\n            this.loading = true;\n            uni.request({\n                url: `${BASE_URL}/orders/${this.orderId}`,\n                method: 'GET',\n                header: new UTSJSONObject({ 'Authorization': `Bearer ${token}` }),\n                success: (res = null) => {\n                    var _a;\n                    if (res.data.success && res.data.data) {\n                        const data = res.data.data;\n                        this.order = data.order || data;\n                    }\n                    else {\n                        uni.showToast({ title: ((_a = res.data) === null || _a === void 0 ? null : _a.message) || '获取详情失败', icon: 'none' });\n                    }\n                },\n                fail: () => {\n                    uni.showToast({ title: '网络错误', icon: 'none' });\n                },\n                complete: () => {\n                    this.loading = false;\n                }\n            });\n        },\n        payOrder() {\n            const token = uni.getStorageSync('token');\n            if (!token) {\n                uni.navigateTo({ url: '/pages/login/login' });\n                return null;\n            }\n            uni.showLoading({ title: '支付中...' });\n            uni.request({\n                url: `${BASE_URL}/orders/${this.orderId}/pay`,\n                method: 'POST',\n                header: new UTSJSONObject({ 'Authorization': `Bearer ${token}` }),\n                success: (res = null) => {\n                    var _a, _b;\n                    if ((_a = res.data) === null || _a === void 0 ? null : _a.success) {\n                        uni.showToast({ title: '支付成功', icon: 'success' });\n                        this.fetchDetail();\n                    }\n                    else {\n                        uni.showToast({ title: ((_b = res.data) === null || _b === void 0 ? null : _b.message) || '支付失败', icon: 'none' });\n                    }\n                },\n                fail: () => {\n                    uni.showToast({ title: '网络错误', icon: 'none' });\n                },\n                complete: () => {\n                    uni.hideLoading();\n                }\n            });\n        },\n        deleteOrder() {\n            const token = uni.getStorageSync('token');\n            if (!token) {\n                uni.navigateTo({ url: '/pages/login/login' });\n                return null;\n            }\n            uni.showModal({\n                title: '删除订单',\n                content: '确定删除该订单吗？',\n                success: (res) => {\n                    if (!res.confirm)\n                        return null;\n                    uni.request({\n                        url: `${BASE_URL}/orders/${this.orderId}`,\n                        method: 'DELETE',\n                        header: new UTSJSONObject({ 'Authorization': `Bearer ${token}` }),\n                        success: (resp = null) => {\n                            var _a, _b;\n                            if ((_a = resp.data) === null || _a === void 0 ? null : _a.success) {\n                                uni.showToast({ title: '已删除', icon: 'success' });\n                                setTimeout(() => {\n                                    uni.switchTab({ url: '/pages/order/list' });\n                                }, 800);\n                            }\n                            else {\n                                uni.showToast({ title: ((_b = resp.data) === null || _b === void 0 ? null : _b.message) || '删除失败', icon: 'none' });\n                            }\n                        },\n                        fail: () => {\n                            uni.showToast({ title: '网络错误', icon: 'none' });\n                        }\n                    });\n                }\n            });\n        }\n    }\n});\n//# sourceMappingURL=D:/order/fontend/pages/order/detail.uvue?vue&type=script&lang.uts.js.map","references":[],"uniExtApis":["uni.getStorageSync","uni.navigateTo","uni.request","uni.showToast","uni.showLoading","uni.hideLoading","uni.showModal","uni.switchTab"],"map":"{\"version\":3,\"file\":\"detail.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"detail.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
